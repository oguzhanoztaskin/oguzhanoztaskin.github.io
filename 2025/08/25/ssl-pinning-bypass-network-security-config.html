<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SSL Pinning Bypass: Network Security Config | Oguzhan’s Tech</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="SSL Pinning Bypass: Network Security Config" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post, I will talk about how I bypassed the simplest SSL pinning method: Network Security Config via APK resource editing. I will also explain my setup." />
<meta property="og:description" content="In this post, I will talk about how I bypassed the simplest SSL pinning method: Network Security Config via APK resource editing. I will also explain my setup." />
<link rel="canonical" href="https://oguzhanstech.com/2025/08/25/ssl-pinning-bypass-network-security-config.html" />
<meta property="og:url" content="https://oguzhanstech.com/2025/08/25/ssl-pinning-bypass-network-security-config.html" />
<meta property="og:site_name" content="Oguzhan’s Tech" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-25T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SSL Pinning Bypass: Network Security Config" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-25T00:00:00+00:00","datePublished":"2025-08-25T00:00:00+00:00","description":"In this post, I will talk about how I bypassed the simplest SSL pinning method: Network Security Config via APK resource editing. I will also explain my setup.","headline":"SSL Pinning Bypass: Network Security Config","mainEntityOfPage":{"@type":"WebPage","@id":"https://oguzhanstech.com/2025/08/25/ssl-pinning-bypass-network-security-config.html"},"url":"https://oguzhanstech.com/2025/08/25/ssl-pinning-bypass-network-security-config.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  
  <!-- KaTeX CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous"><link type="application/atom+xml" rel="alternate" href="https://oguzhanstech.com/feed.xml" title="Oguzhan&apos;s Tech" /><!-- KaTeX JavaScript -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
          onload="renderMathInElement(document.body);"></script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Oguzhan&#39;s Tech</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/archive/">Archive</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper ">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SSL Pinning Bypass: Network Security Config</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-08-25T00:00:00+00:00" itemprop="datePublished">Aug 25, 2025
      </time></p><div class="post-tags"><a href="/archive/#android" class="tag-link">android</a><a href="/archive/#security" class="tag-link">security</a><a href="/archive/#ssl-pinning" class="tag-link">ssl-pinning</a><a href="/archive/#mitmproxy" class="tag-link">mitmproxy</a></div></header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In this post, I will talk about how I bypassed the simplest SSL pinning method: <a href="https://developer.android.com/privacy-and-security/security-config">Network Security Config</a> via APK resource editing. I will also explain my setup.</p>

<p>I assume you know how to use the tools mitmproxy, an Android proxy client, apktool, adb and do not detail it here.</p>

<h2 id="why-do-this-at-all">Why Do This At All?</h2>
<p>SSL Pinning protects your apps their network protocols revealed. Though it is a client side protection and you should focus on server side for the most part, it is still relevant: This will slow down anyone that wants to learn your API, bot it or cheat it.</p>

<p>Studying SSL pinning bypasses is both a fun technical challenge and a way to better understand app defenses. My personal goal here is to observe app traffic directly in mitmproxy, while learning how different protections work.</p>

<h2 id="bypassing-network-security-config">Bypassing Network Security Config</h2>
<p>Bypassing Network Security Config was simple:</p>
<ul>
  <li>Decompile the APK with <a href="https://apktool.org/">apktool</a></li>
  <li>Find the name of the config from <code class="language-plaintext highlighter-rouge">AndroidManifest.xml</code> in the <code class="language-plaintext highlighter-rouge">application</code> tag as the value of <code class="language-plaintext highlighter-rouge">android:networkSecurityConfig</code>, usually it is <code class="language-plaintext highlighter-rouge">res/xml/network_security_config.xml</code></li>
  <li>then set it to be:</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;network-security-config&gt;</span>
    <span class="nt">&lt;base-config</span> <span class="na">cleartextTrafficPermitted=</span><span class="s">"false"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;trust-anchors&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">"system"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">"user"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/trust-anchors&gt;</span>
    <span class="nt">&lt;/base-config&gt;</span>
<span class="nt">&lt;/network-security-config&gt;</span>
</code></pre></div></div>
<p>This will make it trust installed certificates - including the <a href="https://www.mitmproxy.org/">mitmproxy</a>’s certificate if installed. Also if there was any certificate pinned this way, we effectively erased it.<sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<p>We can see that the default setting is to only trust system certificates and no cleartext traffic, for API level 28 and higher according to <a href="https://developer.android.com/privacy-and-security/security-config">here</a>. Therefore, adding user certificates as a trust anchor is necessary.</p>

<p>After this, we can build and sign the app and install it on the target device. Next, we need to put the app’s network traffic through mitmproxy to observe it.</p>

<h2 id="setting-up-the-proxy">Setting up the Proxy</h2>
<p>We need to run mitmproxy on the host and configure the target device to use it. However, the host and the target device possibly lie on different networks and cannot see each other. We cannot make the target device connect to mitmproxy then. I assume a USB connection to the target device is present, so I will use adb to make the devices connect. In the next subsection I explain how.</p>

<h3 id="a-note-on-adb-port-forwarding">A Note on ADB Port Forwarding</h3>
<p>ADB has two useful commands for port forwarding, the second one is something I wish I had seen sooner<sup id="fnref:2"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>. Here I detail them:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb forward tcp:7777 tcp:8888
</code></pre></div></div>
<p>This forwards the port 7777 on the host (i.e. the device running adb, your computer) to the port 8888 on the target device (i.e. your mobile which is connected using a USB cable maybe). What this means is, any connection to port 7777 on your host will be directed to the port 8888 on your target device. For example, if you have an HTTP server listening on port 8888 on your target device, you can access it on your computer via <code class="language-plaintext highlighter-rouge">localhost:7777</code>.</p>

<p>The other command I wish I had learned sooner is the <code class="language-plaintext highlighter-rouge">adb reverse</code> command.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb reverse tcp:3333 tcp:4444
</code></pre></div></div>
<p>This does the opposite of the <code class="language-plaintext highlighter-rouge">adb forward</code> command as the name suggests: The port 3333 on the target device is forwarded to the port 4444 on the host device. That is, if you host the HTTP server on your host at 4444, you can access it on your mobile via <code class="language-plaintext highlighter-rouge">localhost:3333</code>.</p>

<p>Mitmproxy listens at 8080 by default, so we are going to do</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb reverse tcp:8080 tcp:8080
</code></pre></div></div>
<p>Now we can run a http proxy app on the target device and connect it to <code class="language-plaintext highlighter-rouge">127.0.0.1:8080</code> so that it connects to the mitmproxy. Then you should be able to see the network traffic.</p>

<h2 id="conclusion">Conclusion</h2>
<p>We saw how easy it is to bypass the Network Security Config. All we needed to do was decompile, change an XML file, and recompile. To defend against modification of the APK, one can harden their APK using special tools that make apktool fail.</p>

<p><strong>Disclaimer:</strong> This post is intended solely for educational and research purposes. The techniques described here should only be applied to applications you own or have explicit permission to analyze. Reverse engineering, modifying, or intercepting traffic of third-party apps without consent may violate their terms of service and applicable laws. I do not encourage or condone using these methods against third-party apps without permission.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p>Actually I used a script for this and it did not remove the domain-configs and pin-sets, it just added this base-config after them. I thought bypass would fail because pin-set tags would override the base-config, yet it works. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>https://android.googlesource.com/platform/packages/modules/adb/+/refs/heads/master/docs/user/adb.1.md <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div><a class="u-url" href="/2025/08/25/ssl-pinning-bypass-network-security-config.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Oguzhan&#39;s Tech</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Oguzhan&#39;s Tech</li><li><a class="u-email" href="mailto:hello@oguzhanstech.com">hello@oguzhanstech.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/oguzhanoztaskin"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">oguzhanoztaskin</span></a></li><li><a href="https://www.twitter.com/OguzhanOztaskin"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">OguzhanOztaskin</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog about my hustles, which are mostly about cryptography, cyber security, or software projects.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
